extends ../../layouts/default.pug
include ../../mixins/alert.pug



block main 
  if(role.permissions.includes("users_view"))
    +alert-success(5000)

    h1(class="mb-4") Dánh sách người dùng

    .card.mb-3
      .card-header Danh sách 
      .card-body 
        .row 
          .col-8 
          .col-4.text-right 
            if(role.permissions.includes("users_create"))
              a(
                href=`${prefixAdmin}/users/create`
                class = "btn btn-outline-success"
              ) + Thêm mới

      table(
      class="table table-hover table-sm"
  )
        thead
          tr
            th STT
            th Họ tên
            th Email
            th Trạng thái
            th Hành động
      
        tbody
          each item, index in records
            tr
              td #{index+1}
              td #{item.fullName}
              td #{item.email}
              td
                if(role.permissions.includes("users_edit"))
                  if (item.status === "active")
                    a(
                        href="javascript:;"
                        class="badge badge-success"
                        data-status= item.status
                        data-id = item.id
                          button-change-status
                    ) Hoạt động
                  else
                    a(
                        href="javascript:;"
                        class="badge badge-danger"
                        data-status= item.status
                        data-id = item.id
                          button-change-status
                    ) Dừng hoạt động
              td
                a(
                    class="btn btn-secondary btn-sm"
                    href=`${prefixAdmin}/users/detail/${item.id}`
                ) Chi tiết
                if(role.permissions.includes("users_edit"))
                  a(
                    class="btn btn-warning btn-sm ml-1"
                    href=`${prefixAdmin}/users/edit/${item.id}`
                  ) Sửa
                if(role.permissions.includes("users_delete"))
                  button(
                      class="btn btn-danger btn-sm ml-1"
                      button-delete
                      data-id=item.id
                  ) Xóa

      form(action=""
      method="POST"
      id="form-change-status"
      data-path=`${prefixAdmin}/users/change-status`
    )

      form(action=""
      method="POST"
      id="form-delete-user"
      data-path=`${prefixAdmin}/users/delete`
    )
    script(src="/admin/js/user.js")
